✅ 增强版扩散模型已加载
✅ 高级GNN模型已加载

================================================================================
🚀 ULTIMATE PIPELINE 启动
================================================================================
Using device: cuda:0 (Physical GPU 6)
================================================================================
🚀 ULTIMATE PIPELINE 配置
================================================================================
📊 数据增强:
  - 目标比例: 50.0%
  - 质量阈值: 0.7
  - 采样倍数: 5x

🧠 增强版扩散模型:
  - 启用: True
  - 扩散步数 T: 200
  - 上下文维度: 256
  - 最大尝试: 3

🔗 高级GAT-GNN:
  - 启用: True
  - 隐藏层: 256
  - GAT层数: 4
  - 注意力头: 4
  - 训练轮数: 200

🔗 边预测器:
  - 启用: True
  - 阈值: 0.8
  - Top-K: 5

🎯 训练策略:
  - 交叉验证: 3折
  - 集成学习: 3个模型
  - 设备: cuda:0

📁 输出目录: /mnt/data2/Yang/zhq_pro/method2_ppi_training/Augmented_data_balanced
================================================================================

🔍 找到 2 个训练文件
   找到 3 个测试文件

================================================================================
🚀 ULTIMATE PIPELINE: DNA-573_Train
================================================================================

📊 阶段1: 加载训练数据
✅ 加载了 573 个蛋白质
📊 原始数据: 14,479 正 / 145,404 负 (比例: 9.056%)

🧠 训练增强版扩散模型...
  模型类型: 条件扩散 (Conditional DDPM)
  T=200, context_dim=256
🎨 训练增强版扩散模型 (T=200, epochs=100)
  Epoch 1/100 - Loss: 1.0122 - LR: 1.00e-04
  Epoch 21/100 - Loss: 0.8977 - LR: 8.95e-05
  Epoch 41/100 - Loss: 0.8856 - LR: 6.39e-05
  Epoch 61/100 - Loss: 0.8814 - LR: 3.31e-05
  Epoch 81/100 - Loss: 0.8776 - LR: 8.65e-06
  Epoch 100/100 - Loss: 0.8772 - LR: 0.00e+00
✅ 扩散模型训练完成
✅ 扩散模型训练完成: 304.1秒

🔗 加载边预测器 (超稳定版)...
✅ 边预测器已加载 (hidden_dim=1024)
   训练AUC: 0.9300460201827265

🛡️  阶段4: ULTIMATE 数据增强

🚀 ULTIMATE 数据增强开始
  策略: 增强版扩散 + 边预测器 + 质量控制
  目标比例: 50.0%
  质量阈值: 0.7
  采样倍数: 5x
Ultimate augmenting:   0%|          | 0/573 [00:00<?, ?it/s]Ultimate augmenting:   0%|          | 1/573 [00:00<03:44,  2.55it/s]Ultimate augmenting:   0%|          | 2/573 [00:01<07:39,  1.24it/s]Ultimate augmenting:   1%|          | 3/573 [00:08<33:39,  3.54s/it]Ultimate augmenting:   1%|          | 4/573 [00:23<1:16:00,  8.02s/it]Ultimate augmenting:   1%|          | 5/573 [00:24<53:09,  5.62s/it]  Ultimate augmenting:   1%|          | 6/573 [00:25<37:50,  4.00s/it]Ultimate augmenting:   1%|          | 7/573 [00:35<55:24,  5.87s/it]Ultimate augmenting:   1%|▏         | 8/573 [00:38<48:52,  5.19s/it]Ultimate augmenting:   2%|▏         | 9/573 [00:42<44:49,  4.77s/it]Ultimate augmenting:   2%|▏         | 10/573 [00:46<41:56,  4.47s/it]Ultimate augmenting:   2%|▏         | 11/573 [00:47<32:18,  3.45s/it]Ultimate augmenting:   2%|▏         | 12/573 [00:48<24:00,  2.57s/it]Ultimate augmenting:   2%|▏         | 13/573 [00:48<18:34,  1.99s/it]Ultimate augmenting:   2%|▏         | 14/573 [01:40<2:36:57, 16.85s/it]Ultimate augmenting:   3%|▎         | 15/573 [02:13<3:22:51, 21.81s/it]Ultimate augmenting:   3%|▎         | 16/573 [02:16<2:31:43, 16.34s/it]Ultimate augmenting:   3%|▎         | 17/573 [02:21<1:59:02, 12.85s/it]Ultimate augmenting:   3%|▎         | 18/573 [02:25<1:33:30, 10.11s/it]Ultimate augmenting:   3%|▎         | 19/573 [02:27<1:11:07,  7.70s/it]Ultimate augmenting:   3%|▎         | 20/573 [02:29<54:33,  5.92s/it]  Ultimate augmenting:   4%|▎         | 21/573 [02:32<46:12,  5.02s/it]Ultimate augmenting:   4%|▍         | 22/573 [02:32<33:41,  3.67s/it]Ultimate augmenting:   4%|▍         | 23/573 [02:33<24:48,  2.71s/it]Ultimate augmenting:   4%|▍         | 24/573 [04:15<4:57:57, 32.56s/it]